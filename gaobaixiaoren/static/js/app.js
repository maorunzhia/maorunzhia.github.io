"use strict";

function arrayShuffle(e) { for (var t = e.length - 1; t > 0; t--) { var n = 0 | Math.random() * (t + 1),
            r = e[t];
        e[t] = e[n], e[n] = r } return e }

function parseEmoji(e) { var t = [],
        n = e.replace(jEmoji.EMOJI_RE(), function(e, n) { var r = jEmoji.EMOJI_MAP[n]; return t.push(r[2] + ".png"), "\uefee" }); return { text: n, emoji: t } }
NovaExports.exports = { stylesheet: "\n        :host {\n            display: block;\n            color: white;\n        }\n\n        @-webkit-keyframes fadein {\n            from {opacity: 0.0;}\n            to {opacity: 0.9;}\n        }\n\n        @-webkit-keyframes fadeout {\n            from {opacity: 0.9;}\n            to {opacity: 0;}\n        }\n\n        .hint {\n            display: none;\n            position: absolute;\n            overflow: hidden;\n            width: 100%;\n            height: 100%;\n            top: 0;\n            left: 0;\n            background-color: black;\n            padding-left: 30px;\n            padding-top: 40%;\n            font-size: 1.0rem;\n            line-height: 1.2rem;\n        }\n\n        .hint.show {\n            display: block;\n            opacity: 0.9;\n            -webkit-animation-name: fadein;\n            -webkit-animation-duration: 0.3s;\n            -webkit-animation-timing-function: linear; \n            -webkit-animation-fill-mode: both;\n        }\n        \n        .hint.hide {\n            display: block;\n            opacity: 0;\n            -webkit-animation-name: fadeout;\n            -webkit-animation-duration: 0.3s;\n            -webkit-animation-timing-function: linear; \n            -webkit-animation-fill-mode: both;\n        }\n    ", template: '\n        <div class="hint">{{message}}</div>\n    ' }, window.MyEle = NovaExports({ is: "my-dialog", props: { message: { type: String, value: "<strong>\u957f\u6309</strong> \u56fe\u7247\u53ef\u5c06\u56fe\u7247<br>\u4fdd\u5b58\u5230\u76f8\u518c", observer: "_messageChanged" } }, createdHandler: function() {}, attachedHandler: function() {}, _messageChanged: function(t, n, r) {}, show: function(t, n) { t && (this.message = t), $(".hint").addClass("show"); var r = this;
        n || setTimeout(function() { $(".hint").one("click", function() { r.hide() }) }, 500) }, hide: function() { $(".hint").removeClass("show"), $(".hint").addClass("hide"), setTimeout(function() { $(".hint").removeClass("hide") }, 300) } }), "use strict", NovaExports.exports = { stylesheet: "\n        :host {\n            display: block;\n            color: black;\n            overflow: auto;\n            height: 100%;\n        }\n        canvas {\n            display: none;\n        }\n        .littleman-panel {\n            /*-webkit-transform: scale(0.5);\n            -webkit-transform-origin: 0 0;\n            transform: scale(0.5);\n            transform-origin: 0 0;*/\n            zoom: 0.5;\n            margin-bottom: 156px;\n        }\n        .littleman-tip {\n            position: absolute;\n            display: inline-block;\n            width: 150px;\n            height: 50px;\n            bottom: 180px;\n            left: 50%;\n            margin-left: -75px;\n            background-color: rgba(0,0,0,0.7);\n            border-radius: 6px;\n            line-height: 25px;\n            color: white;\n            padding: 5px;\n        }\n    ", template: '\n        <canvas></canvas>\n        <!-- \u7528\u6765\u663e\u793a\u7684\u56fe\u7247 -->\n        <img class="littleman-panel" crossorigin="anonymous">\n        <div class="littleman-tip" style="display:none">&#x63D0;&#x793A;&#xFF1A;&#x8F93;&#x5165;&#x6700;&#x5927;&#x5B57;&#x6570;<br>&#x6700;&#x591A;16&#x884C;&#xFF0C;&#x6BCF;&#x884C;16&#x5B57;</div>\n    ' };
var emoji_root = "http://p8.qhimg.com/d/inn/f0253783/unicode/";
window.MyEle = NovaExports({ is: "my-littleman", props: { text: { type: String, observer: "_textChanged" }, bgcolor: { type: String, observer: "_bgcolorChanged" }, bgfile: { type: String, observer: "_bgfileChanged" }, boardIndex: { type: Number, observer: "_indexChange", value: 11 }, dataURL: String }, createdHandler: function() { this.canvas = $("canvas")[0], this.canvas.width = document.documentElement.clientWidth * 3, this.canvas.height = document.documentElement.clientHeight * 2 - 250, this.update(this.text, 0) }, attachedHandler: function() {}, _textChanged: function(t, n, r) { r || (r = "\u5199\u4e9b\u4f60\u60f3\u8bf4\u7684\u8bdd\n\u7528\u6362\u884c \u7a7a\u683c\n\u6392\u5217\u5c0f\u4eba\uff01"), n ? this.update(r) : this.update(r, 0), Share.setData(wxData) }, _bgcolorChanged: function(t, n, r) { this.bgfile = null, this.backgroundImage = null, $("#container").css("background-color", r), this.update(this.text, 0) }, _bgfileChanged: function(t, n, r) { this.backgroundImage = null, r && tip.show("\u6b63\u5728\u66ff\u6362\u80cc\u666f..."), this.update(this.text, 0) }, _indexChange: function(t, n, r) { this.update(this.text, 0) }, update: function(t, n) { if (t != null && this.canvas) { var r = $(".littleman-tip");
            r.hide(); var i = parseEmoji(t);
            t = i.text; var s = t.split("\n");
            s = s.filter(function(e) { return e.length > 0 }); if (s.length > 16) { r.show(); return } if (!s.every(function(e) { return e.length <= 16 })) { r.show(); return }
            n == null && (n = 650), clearTimeout(this._timer); var o = this;
            this._timer = setTimeout(function() { o.updateCanvas(t, s, i.emoji) }, n) } }, updateCanvas: function(t, n, r) {
        function E() { var e = new Promise(function(e, t) { if (w.bgfile && !w.backgroundImage) { var n = new Image;
                    n.src = w.bgfile, n.onload = function(t) { var n = t.target,
                            r = n.width,
                            i = n.height;
                        typeof ArrayBuffer == "undefined" && (EXIF.getData = function(e, t) { t() }), EXIF.getData(n, function() { var t = EXIF.getTag(this, "Orientation");
                            t == null && (t = 1); var s = Math.min(1, o.width / (t > 4 ? i : r)),
                                u = (t > 4 ? r : i) * s;
                            o.height < u && (o.height = u); if (typeof $baomitu != "undefined") { var a = c / r,
                                    f = h / i;
                                a > f ? (o.width = c, o.height = a * i) : (o.height = h, o.width = f * r), b.drawImage(n, 0, 0, r, i, 0, 0, o.width, o.height), w.backgroundImage = n, e(); return } var l = new Image; if (/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)) { var p = new MegaPixImage(n);
                                p.render(l, { width: r * s, height: i * s, orientation: t, quality: s }) } else { var d = document.createElement("canvas");
                                d.width = r * s, d.height = i * s, d.getContext("2d").drawImage(n, 0, 0, r, i, 0, 0, r * s, i * s), l.src = d.toDataURL("image/png", s) }
                            l.onload = function() { var t = c / l.width,
                                    n = h / l.height;
                                t > n ? (o.width = c, o.height = t * l.height) : (o.height = h, o.width = n * l.width), b.drawImage(l, 0, 0, l.width, l.height, 0, 0, w.canvas.width, w.canvas.height), w.backgroundImage = l, e() } }) } } else w.bgfile ? (b.drawImage(w.backgroundImage, 0, 0, w.backgroundImage.width, w.backgroundImage.height, 0, 0, w.canvas.width, w.canvas.height), e()) : e() }); return e } if (this.canvas == null || t == null) return;
        wx.hideOptionMenu(); var i = location.href.replace(/\?.*$/, "");
        i += "?say=" + encodeURIComponent(t), i += "&bgcolor=" + this.bgcolor, i += "&bdidx=" + this.boardIndex, i += "&preview=1"; var s = Nova.Utils.queryUrl(location.href, "promote");
        s && (i += "&reback=1"), wxData.link = i, Share.setData(wxData); var o = this.canvas,
            u = $(".littleman-panel")[0],
            a = .8,
            f = n.length,
            l = 92 * a,
            c = 0,
            h = 0; for (var p = 0; p < f; p++) { var d = n[p].length;
            c = Math.max(c, f - p - 1 + d), h = Math.max(h, p + 1 + (d - 1) / 3) }
        c = l * c + 120, h = 1.2 * l * h + 160; var v = Math.max(30, 30 + (2 * document.documentElement.clientWidth - c) / 2);
        c = Math.max(document.documentElement.clientWidth * 2, c); if (this.backgroundImage) { var m = c / this.backgroundImage.width,
                g = h / this.backgroundImage.height;
            m > g ? (o.width = c, o.height = m * this.backgroundImage.height) : (o.height = h, o.width = g * this.backgroundImage.width) } else this.backgroundImage || (o.width = c, o.height = h); var y = 35,
            b = o.getContext("2d");
        b.clearRect(0, 0, o.width, o.height), b.fillStyle = this.bgcolor, b.fillRect(0, 0, o.width, o.height); var w = this,
            S = function() { var e = []; for (var t = 0; t < 10; t++) { var n = []; for (var r = 0; r < 20; r++) n.push(r);
                    e.push.apply(e, arrayShuffle(n)) } return e.pos = 0, e }();
        E().then(function() {
            function e(e) { var i = [],
                    s = n[e]; if (s) { for (var o = 0; o < s.length; o++) { var u = s.charAt(o);
                        (function(e, n) { u === "\uefee" && (u = r.shift() || ""), u !== " " && i.push((new LittleMan(u, S[S.pos++ % S.length], w.boardIndex, t)).render().then(function(t) { b.save(), b.translate(v + (f - 2) * l + -e * l + l * .8 + n * l, y + e * l + l * .8 + n * l / 3), b.scale(a, a), b.drawImage(t, 0, 0), b.restore() })) })(e, o) } return Promise.all(i).then(function() { return Promise.resolve(e) }) } return Promise.resolve(e) }
            e(0).then(function i(t) { if (t >= n.length - 1) { var r = o.toDataURL("image/jpeg", .8);
                    tip.hide(), u.src = r, w.dataURL = r; var s = r.replace(/^data:image\/\w+;base64,/, ""),
                        a = "http://h5.mgame.360.cn/activity/index.php?c=photo&m=upload_data_url",
                        f = { dataURL: s };
                    window.AndroidWebview && (a = "http://huodong.mobilem.360.cn/misc/uploadPic", r.indexOf("image/png") >= 0 ? f = { imageFile: s, imageType: "png" } : f = { imageFile: s, imageType: "jpg" }), window.sharePromise = new Promise(function(e, t) { $.ajax({ type: "POST", url: a, data: f, dataType: "json", timeout: 15e3, success: function(n) { if (n.err === "ok" || n.status === 1) { var r = location.href.replace(/[^/]*$/, ""),
                                        i = n.cdn || n.url,
                                        s = $("my-littleman")[0];
                                    wxData.link = r + "preview.html?img=" + encodeURIComponent(i), wxData.link += "&desc=" + encodeURIComponent(s.text), wxData.link += "&bgfile=" + (s.bgfile ? 1 : 0), wxData.link += "&bgcolor=" + encodeURIComponent(s.bgcolor); var o = Nova.Utils.queryUrl(location.href, "promote");
                                    o && (wxData.link += "&reback=1"), console.log(wxData.link), w.shareImg = i, Share.setData(wxData) }
                                wx.showOptionMenu(), e() }, error: function(n, r) { wx.showOptionMenu(), e() } }) }) } else e(t + 1).then(i) }) }) } }), "use strict", NovaExports.exports = { stylesheet: '\n        :host {\n            display: block;\n            color: black;\n        }\n\n        .panel {\n            position:absolute;\n            bottom:0px;\n            width: 100%;\n            height: 166px;\n        }\n\n        .panel-box {\n            padding: 15px 5px;\n            height: 100%;\n            /*background-color:#f9f9f9;*/\n            background: url(static/images/subpanel_bg.png) no-repeat;\n            background-size: 100% 100%;\n            border-radius: 8px 8px 0 0;\n            -webkit-border-radius: 8px 8px 0 0;\n        }\n\n        .mainpanel{\n            overflow: hidden;\n            border-radius: 4px;\n            -webkit-border-radius: 4px;\n        }\n\n        #input {\n            border: 0;\n            width: 100%;\n            height: 100%;\n            background: url(static/images/textarea.png) center no-repeat;\n            background-size: 100% 100%;\n            color: rgb(19,19,19);\n            resize: none;\n            -webkit-box-shadow: none;\n            box-shadow: none;\n            margin: 0;\n            outline: 0;\n            padding: 12px 5px;\n            font-size: 1.0rem;\n            opacity: 0.75;\n        }\n\n        textarea::-webkit-input-placeholder:after {\n            display: block;\n            content: "\u7528\u6362\u884c \u7a7a\u683c\u6392\u5217\u5c0f\u4eba\uff01";\n            color: rgb(159,159,159);\n        } \n        \n        .panel-box ul {\n            margin: 8px 0 0 0;\n            padding: 0;\n            position: relative;\n        }\n\n        .panel-box li {\n            display: inline-block;\n            width: 24%;\n        }\n        \n        .panel-box a {\n            width: 100%;\n            height: 50px;\n            margin: 5px -5px;\n            display: block;\n        }\n        \n        .panel-box ul a span{\n            display: block;\n            width: 50px;\n            height: 50px;\n            margin: auto;\n        }\n\n        .panel-button{\n            position:absolute;\n            width:100%;\n            bottom: 80px;\n        }\n        .panel-button button{\n            position: absolute;\n            margin:0 -112px;\n            left: 50%;\n            border:0;\n            background: transparent;\n            width: 224px;\n            height:40px;\n            background-image: url(static/images/woyeyaogaobai.png);\n            background-size: 100% 100%;\n            background-repeat: no-repeat;\n            outline:none;\n        }\n    ', template: '\n        <div class="panel">\n            <div class="panel-box" style="display:none">\n                <div class="mainpanel">\n                    <textarea id="input" placeholder="&#x5199;&#x4E9B;&#x4F60;&#x60F3;&#x8BF4;&#x7684;&#x8BDD;">{{text}}</textarea>\n                </div>\n                <ul>\n                    <li>\n                        <a href="javascript:;"><span id="setbg" class="button-sprites"></span></a>\n                    </li>\n                    <li>\n                        <a href="javascript:;"><span id="setbd" class="button-sprites"></span></a>\n                    </li>\n                    <li>\n                        <a href="javascript:;"><span id="share" class="button-sprites"></span></a>\n                    </li>\n                    <li>\n                        <a href="javascript:;"><span id="savepic" class="button-sprites"></span></a>\n                    </li>\n                </ul>\n            </div>\n            <div class="panel-button">\n                <button></button>\n            </div>\n        </div>\n\n        <script id="t_user_info" type="text/template">\n            <div class="pop" id="info3" style="height:260px; margin-top:-130px;">\n                <div class="pophd">\u4e2a\u4eba\u8d44\u6599</div>\n                <div class="popbd">\u8bf7\u586b\u5199\u60a8\u7684\u4e2a\u4eba\u8d44\u6599\uff0c\u4ee5\u4fbf\u6211\u4eec\u5c06\u5956\u54c1\u90ae\u5bc4\u7ed9\u60a8~\n                    <form>\n                        <ul class="popli">\n                            <li><span>\u59d3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u540d\uff1a</span> \n                                <input id="nickname" type="text" placeholder="1-5\u4f4d\u4e2d\u6587\u6216\u82f1\u6587"/></li>\n                            <li><span>\u8054\u7cfb\u7535\u8bdd\uff1a</span> <input type="tel" id="phone" placeholder="11\u4f4d\u624b\u673a\u53f7\u7801"/></li>\n                            <li><span>\u90ae\u5bc4\u5730\u5740\uff1a</span> <input type="text" maxlength="100" id="addr"/></li>\n                        </ul>\n                    </form>\n                    <div class="popbtn">\n                        <a href="###" class="btn04" id="confirm_without_info">\u6211\u4e0d\u8981\u5956\u54c1</a>\n                        <a href="###" class="btn02" id="confirm_with_info">\u786e\u5b9a</a>\n                    </div>\n                    <a href="###" class="popf" id="help_info">\u6d3b\u52a8\u8bf4\u660e</a>\n                </div>\n                <span class="close"></span>\n            </div>\n        </script>\n\n        <script id="t_help_info" type="text/template">\n            <div class="pop" id="info3" style="height:260px; margin-top:-130px;">\n                <div class="pophd">\u6d3b\u52a8\u8be6\u60c5</div>\n                <div class="popbd">\u8bf4\u660e\uff1a\u5982\u679c\u4f60\u662f\u5510\u50e7\uff0c\u9a6c\u4e0a\u88ab\u5996\u602a\u6293\u8d70\u4e86\uff0c\u6709\u4ec0\u4e48\u60f3\u5bf9\u609f\u7a7a\u544a\u767d\u7684\uff1f\u6253\u5f00\u8111\u6d1e\u5c3d\u53ef\u80fd\u7684\u521b\u65b0\uff08dou\uff09\u9c9c\uff08bi\uff09\u5427\uff01\u770b\u770b\u7a76\u7adf\u8c01\u80fd\u6253\u52a8\u609f\u7a7a\uff0c\u5e76\u83b7\u5f97\u609f\u7a7a\u7684\u70ed\u793c\u5462\uff01\uff08\u7ed9\u4f60\u559c\u6b22\u7684\u544a\u767d\u70b9\u8d5e\u652f\u6301\u4e0b\uff0c\u6d3b\u52a8\u7ed3\u675f\u540e\u5c06\n        \u6309\u70b9\u8d5e\u6570\u91cf\u53d1\u5956\u54e6~\n                </div>\n                <span class="close"></span>\n            </div>\n        </script>\n\n        <script id="t_share_id" type="text/template">\n            <div class="pop" id="info3" style="height:260px; margin-top:-130px;">\n                <div class="pophd poph">\u8bf7\u8bb0\u4f4f\u60a8\u7684\u544a\u767d\u53f7!</div>\n                <div class="popbd">\u60a8\u53ef\u4ee5\u5c06\u544a\u767d\u53f7\u544a\u8bc9\u60a8\u7684\u5c0f\u4f19\u4f34\uff0c\u5e2e\u60a8\u70b9\u8d5e\u51b2\u699c\u54e6\uff01</div>\n                <div class="pophd pophdhei"><span>\u60a8\u7684\u544a\u767d\u53f7\uff1a</span>123456</div>\n                <div class="popbd">\n                    <p class="popfei">\u957f\u6309\u544a\u767d\u53f7\u590d\u5236</p>\n                    <div class="popbtn">\n                        <a href="hd/index.html" class="btn04">\u8fdb\u5165\u6d3b\u52a8</a>\n                        <a href="javascript:$(\'#share\').trigger(\'touchend\');" id="tell-others" class="btn02">\u544a\u8bc9\u5c0f\u4f19\u4f34</a>\n                    </div>\n                </div>\n                <span class="close"></span>\n            </div>\n        </script>\n    ' }, window.MyEle = NovaExports({ is: "my-panel", props: { text: { type: String, value: "", observer: "_textChanged" } }, createdHandler: function() { var t = this,
            n = Nova.Utils.queryUrl(location.href, "preview");
        n != 1 && ($(".panel-box").show(), $(".panel-button").hide()); var r = $("#input");
        r.on("input", function() { t.text = this.value }), navigator.userAgent.indexOf("iPhone") >= 0 && r.on("focus", function() { window.scrollTo(0, document.documentElement.clientHeight) }); var i = $(".panel-box ul");
        i.on("touchend", function(e) { var t = e.target.id;
            t && ($("my-subpanel")[0].box = t, $("my-subpanel")[0].state = "open"), e.preventDefault() }); var s = "http://h5.mgame.360.cn/activity/index.php?c=photo&m=upload_data_url",
            o = Nova.Utils.queryUrl(location.href, "promote");
        $("#share").on("touchend", function(e) { if (window.AndroidWebview) Share.run();
            else if (typeof $baomitu != "undefined") { var t = { shareImg: $("my-littleman")[0].shareImg || "http://p6.qhimg.com/d/inn/9f331061/icon.jpg", wxData: wxData },
                    n = window.sharePromise || Promise.resolve();
                $baomitu.tip.show("\u6b63\u5728\u4e0a\u4f20\u56fe\u7247\uff0c\u8bf7\u7a0d\u5019..."), n.then(function() { $baomitu.tip.show("\u56fe\u7247\u4e0a\u4f20\u6210\u529f!", 1500), $baomitu.jsonrpc("share", [t], function(e, t, n) { e || alert([t, n]) }) }) } else { var r = o ? "static/images/canjiahuodong.png" : "static/images/share.png";
                $("my-dialog")[0].show('<img src="' + r + '" style="position:absolute;left:50%;margin:0 -86px 0 -120px">') }
            e.stopPropagation() }), o ? ($(".panel-box li").css("width", "22%"), $("#savepic")[0].id = "promote", $("#promote").on("touchend", function(e) { var t = $("my-dialog")[0].message,
                n = $("#t_user_info").text();
            $("my-dialog")[0].show(n); if (localStorage) { var r = localStorage.getItem("userinfo");
                r && (r = JSON.parse(r), $("#nickname").val(r[0]), $("#phone").val(r[1]), $("#addr").val(r[2])) } if (t != n) { $(".pop").on("click", function(e) { var t = e.target;
                    t.className !== "close" && e.stopPropagation() }), $("#help_info").on("click", function(e) { $("my-dialog")[0].show($("#t_help_info").text()), $(".pop").on("click", function(e) { var t = e.target;
                        t.className === "close" && $("#promote").trigger("touchend"), e.stopPropagation() }), e.preventDefault() }); var i = "http://h5.mgame.360.cn/activity/index.php?c=gaobai&callback=?";
                $("#confirm_without_info").on("click", function() { var t = window.sharePromise || Promise.resolve();
                    t.then(function() { $.ajax({ url: i, data: { m: "record_info", img: $("my-littleman")[0].shareImg, token: qStore.util.getMID(), contact: 0, text: $("my-littleman")[0].text }, dataType: "jsonp", success: function(t) { t.err === "ok" ? ($("my-dialog")[0].show($("#t_share_id").text().replace("123456", t.id)), $(".pop").on("click", function(e) { var t = e.target;
                                    t.className !== "close" && e.stopPropagation() })) : alert(t.reason) } }) }), e.preventDefault() }), $("#confirm_with_info").on("click", function() { var t = $("#nickname").val(),
                        n = $("#phone").val(),
                        r = $("#addr").val();
                    localStorage && localStorage.setItem("userinfo", JSON.stringify([t, n, r])); if (t.length < 1 || t.length > 5) { alert("\u8bf7\u586b\u5199\u771f\u5b9e\u59d3\u540d\uff01"), e.preventDefault(); return } if (!n || !r) { alert("\u8bf7\u586b\u5199\u5b8c\u6574\u4fe1\u606f\uff01"), e.preventDefault(); return } if (n.length !== 11) { alert("\u8bf7\u586b\u519911\u4f4d\u624b\u673a\u53f7\u7801"), e.preventDefault(); return } var s = window.sharePromise || Promise.resolve();
                    s.then(function() { $.ajax({ url: i, data: { m: "record_info", img: $("my-littleman")[0].shareImg, token: qStore.util.getMID(), contact: 1, text: $("my-littleman")[0].text, nickname: $("#nickname").val(), phone: $("#phone").val(), addr: $("#addr").val() }, dataType: "jsonp", success: function(t) { t.err === "ok" ? ($("my-dialog")[0].show($("#t_share_id").text().replace("123456", t.id)), $(".pop").on("click", function(e) { var t = e.target;
                                    t.className !== "close" && e.stopPropagation() })) : alert(t.reason) } }) }), e.preventDefault() }) }
            e.stopPropagation() })) : window.AndroidWebview && ($(".panel-box li").css("width", "32%"), $("#savepic").hide()), $("#savepic").on("touchend", function(e) { if (!window.AndroidWebview)
                if (typeof $baomitu != "undefined") { $baomitu.tip.show("\u6b63\u5728\u4fdd\u5b58\u56fe\u7247..."); var t = $("my-littleman")[0].canvas.toDataURL("image/jpeg", .8);
                    $baomitu.jsonrpc("savepic", [t.split(",")[1]], function() { $baomitu.tip.show("\u56fe\u7247\u4fdd\u5b58\u6210\u529f...", 2e3) }) } else $("my-dialog")[0].show('<img src="static/images/preservation.png" style="position:absolute;left:50%;margin:0 -86px 0 -120px">');
            e.stopPropagation() }), $(".panel-button button").on("touchend", function() { location.replace(location.href.replace(/\?.*$/, "")) }) }, attachedHandler: function() {}, _textChanged: function(t, n, r) { typeof littleman != "undefined" && (littleman.text = r) } }), "use strict", NovaExports.exports = { stylesheet: "\n        :host {\n            color: black;\n        }\n\n        #shareB .jiathis_style_32x32{\n            display: none;\n        }\n\n        @-webkit-keyframes close{\n          from {-webkit-transform: translate(0, 0);}\n          to {-webkit-transform: translate(0, 191px);}\n        }\n        \n        @-webkit-keyframes open{\n          from {-webkit-transform: translate(0, 191px);}\n          to {-webkit-transform: translate(0, 0);}\n        }\n\n        .subpanel {\n            position:absolute;\n            bottom:0px;\n            width: 100%;\n            height: 191px;\n            display: block;\n            -webkit-transform: translate(0, 191px);\n        }\n\n        .subpanel.open {\n            -webkit-transform: translate(0, 0);\n            -webkit-backface-visibility: hidden;\n            -webkit-animation-name: open;\n            -webkit-animation-duration: 0.3s;\n            -webkit-animation-timing-function: linear; \n            -webkit-animation-fill-mode: both;\n        }\n\n        .subpanel.closed {\n            -webkit-transform: translate(0, 191px);\n            -webkit-backface-visibility: hidden;\n            -webkit-animation-name: close;\n            -webkit-animation-duration: 0.3s;\n            -webkit-animation-timing-function: linear;  \n            -webkit-animation-fill-mode: both;\n        }\n\n        .takeback {\n            position: relative;\n            background-image: url(static/images/recovery.png);\n            /*background-color:rgb(238,238,239);*/\n            background-size: 100% 100%;\n            background-position: center;\n            background-repeat: no-repeat;\n            width: 50px;\n            height: 25px;\n            margin: 0 auto -12px auto;\n            border-radius: 4px 4px 0 0;\n            -webkit-border-radius: 4px;\n        }\n\n        .subpanel.closed .takeback {\n            -webkit-transform:rotate(180deg);\n            transform:rotate(180deg);\n        }\n\n        .subpanel-box {\n            padding: 12px 5px;\n            height: 100%;\n            /*background-color:#f9f9f9;*/\n            background: url(static/images/subpanel_bg.png) no-repeat;\n            background-size: 100% 100%;\n            border-radius: 8px 8px 0 0;\n            -webkit-border-radius: 8px 8px 0 0;\n        }\n        \n        .subpanel-box ul a span{\n            display: block;\n            width: 50px;\n            height: 50px;\n            margin: auto;\n        }\n\n        .subpanel ul {\n            padding: 0;\n            margin: 0;\n            list-style: none;\n            min-width: 320px;\n        }\n\n        .subpanel-box li.setcolor {\n            width: 20%;\n            height: 30px;\n            margin: 5px auto;\n            float: left;\n            text-align: center;\n        }\n\n        .subpanel-box ul.buttons {\n            clear: both;\n            margin: 0;\n            padding: 0;\n        }\n\n        .subpanel-box ul.buttons.center{\n            line-height: 126px;\n        }\n\n        .subpanel-box ul.buttons.center li{\n            width: 23%;\n        }\n\n        .subpanel-box ul.buttons li {\n            display: inline-block;\n            width: 100%;\n            vertical-align: middle;\n        }\n        \n        .subpanel-box a {\n            width: 100%;\n            height: 50px;\n            margin: 10px auto;\n            display: block;\n        }\n\n        .subpanel-box {\n            display: none;\n        }\n\n        .subpanel.setbg .panel-setbg {\n            display: block;\n        }\n\n        .subpanel.setbd .panel-setbd {\n            display: block;\n        }\n\n        .subpanel.share .panel-share {\n            display: block;\n        }\n        \n        .subpanel form {\n            position: absolute;\n            bottom: 10px;\n            width: 100%;\n            display: block;\n        }\n\n        .subpanel form input{\n            width: 70px;\n            display: block;\n            margin: 0 auto;\n            height: 50px;\n            opacity: 0;\n        }\n    ", template: '\n        <div class="subpanel">\n            <div class="takeback"></div>\n            <div class="subpanel-box panel-setbg">\n                <ul class="color-picker">\n                    <li class="setcolor bgcolors a0" data-color="#d1ebe4"></li>\n                    <li class="setcolor bgcolors a1" data-color="#c8d7ef"></li>\n                    <li class="setcolor bgcolors a2" data-color="#fbab7d"></li>\n                    <li class="setcolor bgcolors a3" data-color="#fdd3d0"></li>\n                    <li class="setcolor bgcolors a4" data-color="#d4effe"></li>\n\n                    <li class="setcolor bgcolors a5" data-color="#dcacd7"></li>\n                    <li class="setcolor bgcolors a6" data-color="#ffce81"></li>\n                    <li class="setcolor bgcolors a7" data-color="#ff8e7f"></li>\n                    <li class="setcolor bgcolors a8" data-color="#dcd4e9"></li>\n                    <li class="setcolor bgcolors a9" data-color="#fac1ac"></li>\n                </ul>\n                <ul class="buttons">\n                    <li style="display:none">\n                        <a href="javascript:;"><span id="choosebg" class="button-sprites"></span></a>\n                    </li>\n                    <li>\n                        <a href="javascript:;"><span id="camera" class="button-sprites"></span></a>\n                    </li>\n                </ul>\n                <form>\n                    <input id="selectfile" accept="image/*;capture=camera" capture="camera" name="selectfile" type="file">\n                </form>\n            </div>\n            <div class="subpanel-box panel-setbd">\n                <ul class="board-picker">\n                <li class="setcolor bdcolors b0" data-idx="0"></li>\n                <li class="setcolor bdcolors b1" data-idx="1"></li>\n                <li class="setcolor bdcolors b3" data-idx="3"></li>\n                <li class="setcolor bdcolors b4" data-idx="4"></li>\n                <li class="setcolor bdcolors b5" data-idx="5"></li>\n                <li class="setcolor bdcolors b6" data-idx="6"></li>\n                <li class="setcolor bdcolors b7" data-idx="7"></li>\n                <li class="setcolor bdcolors b9" data-idx="9"></li>\n                <li class="setcolor bdcolors b10" data-idx="10"></li>\n                <li class="setcolor bdcolors b11" data-idx="11"></li>\n                </ul>\n            </div>\n        </div>\n    ' };
var jiathis_config = { data_track_clickback: !0, summary: "#\u544a\u767d\u5c0f\u4eba#", title: document.getElementsByTagName("my-littleman")[0].text, pic: !1, shortUrl: !1, hideMore: !1 };
window.MyEle = NovaExports({ is: "my-subpanel", props: { state: { type: String, observer: "_stateChanged" }, box: { type: String, observer: "_boxChanged" } }, createdHandler: function() { var t = $(".takeback"),
            n = this;
        t.on("touchend", function() { n.state = "closed" }), $(".color-picker li, .board-picker li").forEach(function(e) { var t = document.createElement("span");
            $(t).css({ width: "30px", height: "30px", display: "block", "border-radius": "50%", "-webkit-border-radius": "50%", margin: "auto" }), e.appendChild(t) }), $(".board-picker").on("touchend", function(e) { var t = e.target.getAttribute("data-idx") || e.target.parentNode.getAttribute("data-idx");
            $("my-littleman")[0].boardIndex = t }), $(".color-picker").on("touchend", function(e) { var t = e.target.getAttribute("data-color") || e.target.parentNode.getAttribute("data-color");
            t && ($("my-littleman")[0].bgcolor = t) }), typeof $baomitu != "undefined" && ($(".buttons #choosebg").parent().parent().show(), $(".buttons li").css("width", "49%"), $(".subpanel form input").hide()), $(".buttons #choosebg, .buttons #camera").on("touchend", function(e) { var t = e.target;
            typeof $baomitu != "undefined" && (t.id === "choosebg" ? $baomitu.jsonrpc("chooseFile", [], function(e, t, n) { e || ($("my-littleman")[0].bgfile = "data:image/jpeg;base64," + t) }) : t.id === "camera" && $baomitu.jsonrpc("takePhoto", [], function(e, t, n) { e || ($("my-littleman")[0].bgfile = "data:image/jpeg;base64," + t) })), $("#selectfile").click(), e.preventDefault() }), $("#selectfile").on("change", function(e) { var t = e.target,
                n = t.files[0],
                r = window.URL || window.webkitURL; if (r) { var i = r.createObjectURL(n);
                $("my-littleman")[0].bgfile = i } else { var s = new FileReader;
                s.readAsDataURL(n), s.onload = function(e) { $("my-littleman")[0].bgfile = this.result } } }) }, attachedHandler: function() {}, _stateChanged: function(t, n, r) { var i = $(".subpanel");
        i.hasClass(n) && i.removeClass(n), i.addClass(r) }, _boxChanged: function(t, n, r) { $(".subpanel").addClass(r), n && $(".subpanel").removeClass(n) } });